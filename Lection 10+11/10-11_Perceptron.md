# 10 –ó–∞–Ω—è—Ç–∏–µ –ø—Ä–æ –ü–µ—Ä—Ü–µ–ø—Ç—Ä–æ–Ω

## –ß—Ç–æ —Ç–∞–∫–æ–µ –Ω–µ–π—Ä–æ–Ω–Ω–∞—è —Å–µ—Ç—å
**–ù–µ–π—Ä–æ–Ω–Ω–∞—è —Å–µ—Ç—å** ‚Äî —ç—Ç–æ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –Ω–µ–π—Ä–æ–Ω–æ–≤, —Å–æ–µ–¥–∏–Ω–µ–Ω–Ω—ã—Ö –º–µ–∂–¥—É —Å–æ–±–æ–π —Å–∏–Ω–∞–ø—Å–∞–º–∏. –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –Ω–µ–π—Ä–æ–Ω–Ω–æ–π —Å–µ—Ç–∏ –ø—Ä–∏—à–ª–∞ –≤ –º–∏—Ä –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è –ø—Ä—è–º–∏–∫–æ–º –∏–∑ –±–∏–æ–ª–æ–≥–∏–∏. –ë–ª–∞–≥–æ–¥–∞—Ä—è —Ç–∞–∫–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–µ, –º–∞—à–∏–Ω–∞ –æ–±—Ä–µ—Ç–∞–µ—Ç —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å –∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∏ –¥–∞–∂–µ –∑–∞–ø–æ–º–∏–Ω–∞—Ç—å —Ä–∞–∑–ª–∏—á–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é. –ù–µ–π—Ä–æ–Ω–Ω—ã–µ —Å–µ—Ç–∏ —Ç–∞–∫–∂–µ —Å–ø–æ—Å–æ–±–Ω—ã –Ω–µ —Ç–æ–ª—å–∫–æ –∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –≤—Ö–æ–¥—è—â—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é, –Ω–æ –∏ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç—å –µ–µ –∏–∑ —Å–≤–æ–µ–π –ø–∞–º—è—Ç–∏.  
![–ù–µ–π—Ä–æ–Ω](http://aboutyourself.ru/assets/sinaps.jpg)
**–ê–∫—Å–æ–Ω** ‚Äî –¥–ª–∏–Ω–Ω—ã–π –æ—Ç—Ä–æ—Å—Ç–æ–∫ –Ω–µ–π—Ä–æ–Ω–∞. –ü—Ä–∏—Å–ø–æ—Å–æ–±–ª–µ–Ω –¥–ª—è –ø—Ä–æ–≤–µ–¥–µ–Ω–∏—è –≤–æ–∑–±—É–∂–¥–µ–Ω–∏—è –∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ—Ç —Ç–µ–ª–∞ –Ω–µ–π—Ä–æ–Ω–∞ –∫ –Ω–µ–π—Ä–æ–Ω—É –∏–ª–∏ –æ—Ç –Ω–µ–π—Ä–æ–Ω–∞ –∫ –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–º—É –æ—Ä–≥–∞–Ω—É.  
**–î–µ–Ω–¥—Ä–∏—Ç—ã** ‚Äî –∫–æ—Ä–æ—Ç–∫–∏–µ –∏ —Å–∏–ª—å–Ω–æ —Ä–∞–∑–≤–µ—Ç–≤–ª—ë–Ω–Ω—ã–µ –æ—Ç—Ä–æ—Å—Ç–∫–∏ –Ω–µ–π—Ä–æ–Ω–∞, —Å–ª—É–∂–∞—â–∏–µ –≥–ª–∞–≤–Ω—ã–º –º–µ—Å—Ç–æ–º –¥–ª—è –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è –≤–ª–∏—è—é—â–∏—Ö –Ω–∞ –Ω–µ–π—Ä–æ–Ω –≤–æ–∑–±—É–∂–¥–∞—é—â–∏—Ö –∏ —Ç–æ—Ä–º–æ–∑–Ω—ã—Ö —Å–∏–Ω–∞–ø—Å–æ–≤ (—Ä–∞–∑–Ω—ã–µ –Ω–µ–π—Ä–æ–Ω—ã –∏–º–µ—é—Ç —Ä–∞–∑–ª–∏—á–Ω–æ–µ —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ –¥–ª–∏–Ω—ã –∞–∫—Å–æ–Ω–∞ –∏ –¥–µ–Ω–¥—Ä–∏—Ç–æ–≤), –∏ –∫–æ—Ç–æ—Ä—ã–µ –ø–µ—Ä–µ–¥–∞—é—Ç –≤–æ–∑–±—É–∂–¥–µ–Ω–∏–µ –∫ —Ç–µ–ª—É –Ω–µ–π—Ä–æ–Ω–∞. 

### –°–∏–Ω–∞–ø—Å –Ω–µ–π—Ä–æ–Ω–Ω–æ–π —Å–µ—Ç–∏
<img src="images/synaps.png" alt="Synaps" height=20% width=20%>

## –ü–µ—Ä—Ü–µ–ø—Ç—Ä–æ–Ω
<img src="images/perceptron.png" alt="vector scalar multiplication" width=50% height=50% >

$A$ - –≤—Ö–æ–¥—è—â–∏–π –≤–µ–∫—Ç–æ—Ä –ø—Ä–∏–∑–Ω–∞–∫–æ–≤  
$W$ - –≤–µ—Å–∞ –º–æ–¥–µ–ª–∏  
$b = w_0$ - —Å–¥–≤–∏–≥ –º–æ–¥–µ–ª–∏   
$y$ - —Ä–µ–∑—É–ª—å—Ç–∞—Ç –º–æ–¥–µ–ª–∏  
$\sigma$ - —Ñ—É–Ω–∫—Ü–∏—è –∞–∫—Ç–∏–≤–∞—Ü–∏–∏

**<center>–°–º–µ—â–µ–Ω–∏–µ</center>**
$$
A_0 = 1
$$
$$
S = \sum_{i=0}^nA_iw_i
$$

X = [x1, x2, x3]; 
W = [w1, w2, w3]; 
$ b = w_0 $
$$
\vec x * \vec W = w_0 + x_1w_1 + x_2w_2 + x_3w_3
$$


## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –Ω–∞–±–æ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö MNIST –≤ Python
–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö MNIST (—Å–æ–∫—Ä–∞—â–µ–Ω–∏–µ –æ—Ç ¬´Modified National Institute of Standards and Technology¬ª) ‚Äî —ç—Ç–æ –Ω–∞–±–æ—Ä –æ–±—Ä–∞–∑—Ü–æ–≤ —Ä—É–∫–æ–ø–∏—Å–Ω–æ–≥–æ –Ω–∞–ø–∏—Å–∞–Ω–∏—è —Ü–∏—Ñ—Ä. 
–Ø–≤–ª—è–µ—Ç—Å—è —Å—Ç–∞–Ω–¥–∞—Ä—Ç–æ–º –¥–ª—è –∫–∞–ª–∏–±—Ä–∞—Ü–∏–∏ –∏ —Å–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏—è –º–µ—Ç–æ–¥–æ–≤ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π,
—Å –ø–æ–º–æ—â—å—é –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è, –≤ –ø–µ—Ä–≤—É—é –æ—á–µ—Ä–µ–¥—å –Ω–∞ –æ—Å–Ω–æ–≤–µ –Ω–µ–π—Ä–æ–Ω–Ω—ã—Ö —Å–µ—Ç–µ–π.  

### –ó–Ω–∞–∫–æ–º—Å—Ç–≤–æ
```python
# Importing the necessary libraries
import numpy as np
import matplotlib.pyplot as plt
import torchvision
plt.rcParams['figure.figsize'] = 10, 10
```
–§—É–Ω–∫—Ü–∏—è —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
```python
transform = torchvision.transforms.Compose([
                    torchvision.transforms.ToTensor(),
                    torchvision.transforms.Normalize((0.5), (0.5))
                                            ])
```
–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –Ω–∞–±–æ—Ä–∞
```python
train_dataset = torchvision.datasets.MNIST(
    root="./MNIST/train", train=True,
    transform=torchvision.transforms.ToTensor(),
    download=False)

test_dataset = torchvision.datasets.MNIST(
    root="./MNIST/test", train=False,
    transform=torchvision.transforms.ToTensor(),
    download=False)
```
–†–∞—Å—Å–º–æ—Ç—Ä–∏–º 25 —Å–ª—É—á–∞–π–Ω—ã—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –∏–∑ –Ω–∞–±–æ—Ä–∞ 
```python
# –°–æ–∑–¥–∞—ë–º –Ω–æ–º–µ—Ä–∞ –≤—ã–±–æ—Ä–∫–∏
random_samples = np.random.randint(1, len(train_dataset), (25))

# –†–∞—Å–∫–ª–∞–¥—ã–≤–∞–µ–º –≤—ã–±–æ—Ä–∫—É –Ω–∞ —Ö–æ–ª—Å—Ç–µ
for idx in range(random_samples.shape[0]):
    plt.subplot(5, 5, idx + 1)
    plt.imshow(train_dataset[idx][0][0].numpy(), cmap='gray')
    plt.title(train_dataset[idx][1])
    plt.axis('off')

# –°–º–æ—Ç—Ä–∏–º –ø–æ–ª—É—á–∏–≤—à–∏–π—Å—è —Ö–æ–ª—Å—Ç
plt.tight_layout()
plt.show()
```
![png](images/10_Perceptron_7_0.png)  
–≠–ª–µ–º–µ–Ω—Ç `train_dataset[0]` —ç—Ç–æ `(Img, label)`.

### –¢—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏—è –≤ —É–¥–æ–±–æ–≤–∞—Ä–∏–º—ã–π –≤–∏–¥
–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤
```python
def encode_label(j):
	"""
	–ü–µ—Ä–µ–≤–æ–¥–∏—Ç —á–∏—Å–ª–æ-–ø—Ä–∏–∑–Ω–∞–∫ –≤ –º–∞—Ç—Ä–∏—Ü—É:
	5 -> [[0], [0], [0], [0], [0], [1], [0], [0], [0], [0]]
	       0,   1,   2,   3,   4,   5,   6,   7,   8,   9.  
	"""
	
	e = np.zeros((10,1))
	e[j] = 1.0
	return e

def shape_data(data):
	features = [np.reshape(x[0][0].numpy(), (784,1)) for x in data]
	labels = [encode_label(y[1]) for y in data]
	return zip(features, labels)


train = shape_data(train_dataset)
test = shape_data(test_dataset)
```
–ü—Ä–æ–≤–µ—Ä–∫–∞
```python
train = list(train)
test = list(test)
print('train imgs -', len(train))
print('test imgs -', len(test))
```
    train imgs - 60000
    test imgs - 10000

## –ü–µ—Ä—Ü–µ–ø—Ç—Ä–æ–Ω –≤ Python
### –¢–µ–æ—Ä–∏—è
–î–ª—è –æ–±—É—á–µ–Ω–∏—è –ø–µ—Ä—Ü–µ–ø—Ç—Ä–æ–Ω–∞ –¥–ª—è —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è —Ü–∏—Ñ—Ä –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–ª–µ–¥—É—é—â–∏–π –ø–æ–¥—Ö–æ–¥:  
* –î–ª—è –∫–∞–∂–¥–æ–π —Ü–∏—Ñ—Ä—ã —Ö—Ä–∞–Ω–∏—Ç—Å—è —Å—Ä–µ–¥–Ω–µ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –≤ –≤–∏–¥–µ –º–∞—Ç—Ä–∏—Ü—ã.
* –ü–æ–¥–±–∏—Ä–∞–µ—Ç—Å—è —Ç–∞–∫–æ–π –≤–µ–∫—Ç–æ—Ä –≤–µ—Å–æ–≤ $W$, —á—Ç–æ–±—ã —Å–∫–∞–ª—è—Ä–Ω–æ–µ –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ –≤–µ–∫—Ç–æ—Ä–∞, –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—é—â–µ–≥–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ü–∏—Ñ—Ä—ã, —Å —ç—Ç–∏–º –≤–µ–∫—Ç–æ—Ä–æ–º –¥–∞–≤–∞–ª–æ –Ω–∞–∏–±–æ–ª—å—à–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ.  

<img src="images/vec_multiplication.jpg" alt="vector scalar multiplication" width=40% height=40%>  
–ì–¥–µ $V$ - —ç—Ç–æ –≤–µ–∫—Ç–æ—Ä –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è, $W$ - –≤–µ—Å–∞ –Ω–µ–π—Ä–æ—Å–µ—Ç–∏.  

–†–∞—Å—Å–º–æ—Ç—Ä–∏–º —Å—Ä–µ–¥–Ω–µ–µ  –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ  —Ü–∏—Ñ—Ä—ã  8 (`avg_eight`):
```python
def average_digit(data, digit):
    filtered_data = [x[0] for x in data if np.argmax(x[1]) == digit]
    filtered_array = np.asarray(filtered_data)
    return np.average(filtered_array, axis=0)

avg_eight = average_digit(train, 8)

img = (np.reshape(avg_eight, (28, 28)))
plt.imshow(img)
plt.show()
```
![png](images/10_Perceptron_23_0.png)  

–≠—Ç–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∏–∑ –æ–±—É—á–∞—é—â–µ–≥–æ –Ω–∞–±–æ—Ä–∞ MNIST —Å–æ–¥–µ—Ä–∂–∏—Ç –±–æ–ª—å—à–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —Ç–æ–º, –∫–∞–∫–∏–º–∏ –æ–±—â–∏–º–∏ —Å–≤–æ–π—Å—Ç–≤–∞–º–∏ –¥–æ–ª–∂–Ω—ã –æ–±–ª–∞–¥–∞—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è —Ü–∏—Ñ—Ä—ã 8.
–ú—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º `avg_eight` –≤ –∫–∞—á–µ—Å—Ç–≤–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –ø—Ä–æ—Å—Ç–æ–π –º–æ–¥–µ–ª–∏, —á—Ç–æ–±—ã –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å, —è–≤–ª—è–µ—Ç—Å—è –ª–∏ –¥–∞–Ω–Ω—ã–π –≤—Ö–æ–¥–Ω–æ–π –≤–µ–∫—Ç–æ—Ä $x$, –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—é—â–∏–π –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ü–∏—Ñ—Ä—ã, –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ–º –≤–æ—Å—å–º—ë—Ä–∫–∏.
–í –¥–∞–Ω–Ω–æ–º —Å–ª—É—á–∞–µ `avg_eight` –≤—ã—Å—Ç—É–ø–∞–µ—Ç –≤ –∫–∞—á–µ—Å—Ç–≤–µ –≤–µ—Å–æ–≤.  

```python
# train[ indx ][ img/label ]
x_2 = train[2][0] # 4-–∫–∞
x_17 = train[17][0] # 8-–∫–∞

img_2 = (np.reshape(x_2, (28, 28)))
img_17 = (np.reshape(x_17, (28, 28)))

plt.subplot(1, 2, 1)
plt.imshow(img_2)
plt.subplot(1, 2, 2)
plt.imshow(img_17)
plt.show()
```
![png](images/10_Perceptron_27_0.png)

–í—ã—á–∏—Å–ª–∏–º —Å–∫–∞–ª—è—Ä–Ω–æ–µ –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ W –∏¬†x, —Ç.¬†–µ. –ø–æ–ø–∞—Ä–Ω–æ –ø–µ—Ä–µ–º–Ω–æ–∂–∏–º –∑–Ω–∞—á–µ–Ω–∏—è W –∏¬†x –∏¬†—Å—É–º–º–∏—Ä—É–µ–º –≤—Å–µ 784 —Ä–µ–∑—É–ª—å—Ç–∏—Ä—É—é—â–∏—Ö –∑–Ω–∞—á–µ–Ω–∏—è.
–ï—Å–ª–∏ –Ω–∞—à–∞ –≥–∏–ø–æ—Ç–µ–∑–∞ –≤–µ—Ä–Ω–∞ –∏¬†x —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç 8,
—Ç–æ –±–æ–ª–µ–µ —Ç–µ–º–Ω—ã–µ –ø–∏–∫—Å–µ–ª–∏ –¥–æ–ª–∂–Ω—ã —Ä–∞—Å–ø–æ–ª–∞–≥–∞—Ç—å—Å—è –ø—Ä–∏–º–µ—Ä–Ω–æ –≤¬†—Ç–µ—Ö –∂–µ –º–µ—Å—Ç–∞—Ö, —á—Ç–æ –∏¬†–≤¬†—Å–ª—É—á–∞–µ W, –∏¬†–Ω–∞–æ–±–æ—Ä–æ—Ç.
–ï—Å–ª–∏ –∂–µ —Ö –Ω–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç 8, —Ç–æ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–π –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –º–µ–Ω—å—à–µ.
–î–∞–≤–∞–π—Ç–µ –ø—Ä–æ–≤–µ—Ä–∏–º —ç—Ç—É –≥–∏–ø–æ—Ç–µ–∑—É –Ω–∞ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –ø—Ä–∏–º–µ—Ä–∞—Ö.

```python
W = np.transpose(avg_eight)

res_4by8 = np.dot(W, x_2)[0][0] / np.linalg.norm(W)
print(res_4by8) 
```
    2.7090142
```python
res_8by8 = np.dot(W, x_17)[0][0] / np.linalg.norm(W)
print(res_8by8)
```
    7.351549

### –§—É–Ω–∫—Ü–∏—è –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ –ø–µ—Ä—Ü–µ–ø—Ç—Ä–æ–Ω–∞
–î–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è **—Å—Ç—É–ø–µ–Ω—á–∞—Ç–∞—è —Ñ—É–Ω–∫—Ü–∏—è –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ (binary step function)**:  
F(x)={1,–µ—Å–ª–∏ x‚â•0,0,–µ—Å–ª–∏ x<0.  
  
\begin{equation}
    \begin{matrix}
    {F(x)} & =
    & \left\{
    \begin{matrix}
    1 &  \mbox{if } x \geq 0  \\
    0 &  \mbox{if } x < 0 & 
    \end{matrix} \right.
    \end{matrix}
\end{equation}

<img src="images/binary_step_function.png" alt="Binary" height=40% width=40%>

```python
def binary_step(x):
    return 1.0 if x>=0 else 0

res = binary_step(res_4by8)
print(f"–≠—Ç–æ 8-–∫–∞ - {bool(res)}")
```
    –≠—Ç–æ 8-–∫–∞ - True
```python
res = binary_step(res_8by8)
print(f"–≠—Ç–æ 8-–∫–∞ - {bool(res)}")
```
    –≠—Ç–æ 8-–∫–∞ - True  

–î–æ–±–∞–≤–∏–º "—Å–º–µ—â–µ–Ω–∏–µ" $b$:
```python
b = -45

def predict(x, W, b):
    return binary_step((np.dot(W,x) + b)/ np.linalg.norm(W))

res = predict(x_2, W, b)
print(f"–≠—Ç–æ 8-–∫–∞ - {bool(res)}")
```
    –≠—Ç–æ 8-–∫–∞ - False
```python
res = predict(x_17, W, b)
print(f"–≠—Ç–æ 8-–∫–∞ - {bool(res)}")
```
    –≠—Ç–æ 8-–∫–∞ - True  

–í–µ—Ä–Ω–æ—Å—Ç—å –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π "–≤–æ—Å—å–º–µ—Ä–æ–∫" –Ω–∞—à–µ–π –ø—Ä–æ—Å—Ç–æ–π –º–æ–¥–µ–ª—å—é —Å–æ—Å—Ç–∞–≤–ª—è–µ—Ç 78% –Ω–∞ –æ–±—É—á–∞—é—â–∏—Ö –¥–∞–Ω–Ω—ã—Ö –∏ 77% –Ω–∞ —Ç–µ—Å—Ç–æ–≤—ã—Ö.

### –ü–æ–ª–Ω–æ—Å–≤—è–∑–Ω–∞—è —Å–µ—Ç—å (Fully Connected)

<img src="images/LessonsII/mnist_fc.png" alt="FC" height=40% width=40%>  
<video src="data/FC.mp4" controls>Your browser does not support the <code>video</code> element.</video>  

[2D Visualization of a Fully-Connected Neural Network](https://adamharley.com/nn_vis/mlp/2d.html)  

**–ú–∏–Ω—É—Å—ã**:  
- –ë–æ–ª—å—à–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤.  
- –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —Ç—Ä–∞–Ω—Å–ª—è—Ü–∏–æ–Ω–Ω–æ–π –∏–Ω–≤–∞—Ä–∏–∞–Ω—Ç–Ω–æ—Å—Ç–∏.  

---

## –ù–µ–π—Ä–æ–Ω –∫–∞–∫ —Ä–∞–∑–¥–µ–ª—è—é—â–∞—è –≥–∏–ø–µ—Ä–ø–ª–æ—Å–∫–æ—Å—Ç—å
–ß—Ç–æ –º—ã —Å–¥–µ–ª–∞–ª–∏, –Ω–∞–π–¥—è –∫–æ–ª–ª–∏–Ω–µ–∞—Ä–Ω—ã–π –≤–µ–∫—Ç–æ—Ä \( W = \text{avg\_eight} \) –∏ —Å–º–µ—â–µ–Ω–∏–µ \( b \)?  

<img src="images/avg_digit.png" alt="average digit" height=30% width=30%>  

–ü—Ä—è–º–∞—è –ª–∏–Ω–∏—è –Ω–∞ –ø–ª–æ—Å–∫–æ—Å—Ç–∏ –∑–∞–¥–∞—ë—Ç—Å—è —É—Ä–∞–≤–Ω–µ–Ω–∏–µ–º:  
\[
x_1 w_1 + x_2 w_2 + b = 0 \quad \text{–∏–ª–∏} \quad \vec{x}^T \cdot \vec{w} + b = 0
\]  

–ì–¥–µ –ø–µ—Ä–≤—ã–µ –¥–≤–∞ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–∞ \( w_1, w_2 \) –∑–∞–¥–∞—é—Ç —Å–µ–º–µ–π—Å—Ç–≤–æ –ø—Ä—è–º—ã—Ö –ª–∏–Ω–∏–π, –ø—Ä–æ—Ö–æ–¥—è—â–∏—Ö —á–µ—Ä–µ–∑ —Ç–æ—á–∫—É (0, 0). –°–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ –º–µ–∂–¥—É \( w_1 \) –∏ \( w_2 \) –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç —É–≥–æ–ª –Ω–∞–∫–ª–æ–Ω–∞ –ø—Ä—è–º–æ–π.  
–í–µ–∫—Ç–æ—Ä \( (w_1, w_2) \) ‚Äî —ç—Ç–æ –Ω–æ—Ä–º–∞–ª—å –∫ –ø—Ä—è–º–æ–π \( w_1 x_1 + w_2 x_2 + b = 0 \):  

–¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, –Ω–∞—à –≤–µ–∫—Ç–æ—Ä \( \vec{W} = \text{avg\_eight} \) —è–≤–ª—è–µ—Ç—Å—è –Ω–æ—Ä–º–∞–ª—å—é –∫ –ø—Ä—è–º–æ–π \( x_1 w_1 + x_2 w_2 + b = 0 \).  

<img src="images/normal_line.png" alt="normal to the line" height=30% width=30%>  

–í—Å–µ —Ç–æ—á–∫–∏ \( \vec{x} \), –ª–µ–∂–∞—â–∏–µ –Ω–∞ —ç—Ç–æ–π –ø—Ä—è–º–æ–π, –ø—Ä–∏ —Å–∫–∞–ª—è—Ä–Ω–æ–º —É–º–Ω–æ–∂–µ–Ω–∏–∏ –Ω–∞ \( \vec{w} \) –¥–∞—é—Ç 0.  
- –ï—Å–ª–∏ —Ç–æ—á–∫–∞ \( \vec{x} \) –ª–µ–∂–∏—Ç "–Ω–∞–¥ –ø—Ä—è–º–æ–π", —Ç–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç \( > 0 \).  
- –ï—Å–ª–∏ —Ç–æ—á–∫–∞ "–ø–æ–¥ –ø—Ä—è–º–æ–π" ‚Äî \( < 0 \).  

–î—Ä—É–≥–∏–º–∏ —Å–ª–æ–≤–∞–º–∏:  
\[
\vec{w}^T \cdot \vec{x} + b > 0 \quad \text{‚Äî —Ç–æ—á–∫–∞ –ª–µ–∂–∏—Ç ¬´–≤—ã—à–µ¬ª –≥–∏–ø–µ—Ä–ø–ª–æ—Å–∫–æ—Å—Ç–∏}
\]  
\[
\vec{w}^T \cdot \vec{x} + b < 0 \quad \text{‚Äî —Ç–æ—á–∫–∞ –ª–µ–∂–∏—Ç ¬´–Ω–∏–∂–µ¬ª –≥–∏–ø–µ—Ä–ø–ª–æ—Å–∫–æ—Å—Ç–∏}
\]  

<img src="images/dist.png" alt="distance to hyperplane" height=15% width=15%>  

–†–∞—Å—Å—Ç–æ—è–Ω–∏–µ –æ—Ç –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω–æ–π —Ç–æ—á–∫–∏ \( \vec{x} \) –¥–æ –≥–∏–ø–µ—Ä–ø–ª–æ—Å–∫–æ—Å—Ç–∏ —Ä–∞–≤–Ω–æ:  
\[
d(\vec{x}) = \frac{\vec{w}^T \cdot \vec{x} + b}{\|\vec{w}\|}
\]  

---

### –ù–µ–π—Ä–æ–Ω –∫–∞–∫ –≤—ã—á–∏—Å–ª–∏—Ç–µ–ª—å —Ä–∞—Å—Å—Ç–æ—è–Ω–∏—è –¥–æ –≥–∏–ø–µ—Ä–ø–ª–æ—Å–∫–æ—Å—Ç–∏

–ù–µ–π—Ä–æ–Ω –≤—ã—á–∏—Å–ª—è–µ—Ç —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ \( d \) –æ—Ç —Ç–æ—á–∫–∏ —Å –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞–º–∏ \( \vec{x} = (x_1, \dots, x_n) \) (–≤–µ–∫—Ç–æ—Ä –≤—Ö–æ–¥–æ–≤) –¥–æ –≥–∏–ø–µ—Ä–ø–ª–æ—Å–∫–æ—Å—Ç–∏, –∑–∞–¥–∞–≤–∞–µ–º–æ–π –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ \( b \) –∏ \( \vec{\omega} = (w_1, \dots, w_n) \):  
- \( \vec{\omega} \) –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–æ—Ä–º–∞–ª–∏ –≥–∏–ø–µ—Ä–ø–ª–æ—Å–∫–æ—Å—Ç–∏.  
- \( b \) –∑–∞–¥–∞—ë—Ç —Å–º–µ—â–µ–Ω–∏–µ –ø–ª–æ—Å–∫–æ—Å—Ç–∏ –≤–¥–æ–ª—å –≤–µ–∫—Ç–æ—Ä–∞ \( \vec{\omega} \).  

<img src="images/hyper_neuron.png" alt="neuron and hyperplane" height=30% width=30%>  

–ï—Å–ª–∏ –¥–≤–∞ –∫–ª–∞—Å—Å–∞ –≤ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ —Ä–∞–∑–¥–µ–ª—è—é—Ç—Å—è –≥–∏–ø–µ—Ä–ø–ª–æ—Å–∫–æ—Å—Ç—å—é, —Ç–æ –¥–ª—è –∏—Ö —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –æ–¥–Ω–æ–≥–æ –Ω–µ–π—Ä–æ–Ω–∞.  

–°–ª–æ–π, —Å–æ—Å—Ç–æ—è—â–∏–π –∏–∑ —Ç—Ä—ë—Ö –Ω–µ–π—Ä–æ–Ω–æ–≤, —Ä–∞–±–æ—Ç–∞–µ—Ç —Å–ª–µ–¥—É—é—â–∏–º –æ–±—Ä–∞–∑–æ–º: –∫–∞–∂–¥—ã–π –Ω–µ–π—Ä–æ–Ω –æ—Ç–¥–µ–ª—è–µ—Ç "—Å–≤–æ–π –∫–ª–∞—Å—Å" –æ—Ç –æ—Å—Ç–∞–ª—å–Ω—ã—Ö –¥–≤—É—Ö.  

<img src="images/hyper_neurons.png" alt="neuron layer" height=30% width=30%>  

[–°—Ç–∞—Ç—å—è –°–µ—Ä–≥–µ—è –°—Ç—ë–ø–∏–Ω–∞, –ø–æ—Å–≤—è—â—ë–Ω–Ω–∞—è –Ω–µ–π—Ä–æ–Ω–Ω—ã–º —Å–µ—Ç—è–º](http://synset.com/ai/ru/nn/NeuralNet_01_Intro.html).


# 11 –ó–∞–Ω—è—Ç–∏–µ
## –ó–∞—á–µ–º –Ω—É–∂–µ–Ω —Å–∫—Ä—ã—Ç—ã–π —Å–ª–æ–π?
–ü–µ—Ä–µ–π–¥—ë–º —Ç–µ–ø–µ—Ä—å –∫ —á—É—Ç—å –±–æ–ª–µ–µ —Å–ª–æ–∂–Ω–æ–π –∑–∞–¥–∞—á–µ. –ü—É—Å—Ç—å –æ–±—ä–µ–∫—Ç—ã –¥–≤—É—Ö –∫–ª–∞—Å—Å–æ–≤ (–∫—Ä—É–∂–æ—á–∫–∏ –∏ –∫—Ä–µ—Å—Ç–∏–∫–∏) —Å–æ—Å—Ä–µ–¥–æ—Ç–æ—á–µ–Ω—ã –ø–æ —É–≥–ª–∞–º –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ —Ç–∞–∫, –∫–∞–∫ –Ω–∞ —Ä–∏—Å—É–Ω–∫–µ. –û–¥–Ω–æ–π –≥–∏–ø–µ—Ä–ø–ª–æ—Å–∫–æ—Å—Ç—å—é (–ª–∏–Ω–∏–µ–π) —ç—Ç–∏ –¥–≤–∞ –∫–ª–∞—Å—Å–∞ —Ä–∞–∑–¥–µ–ª–∏—Ç—å –Ω–µ–ª—å–∑—è. –ò–Ω–æ–≥–¥–∞ —Ç–∞–∫—É—é –∑–∞–¥–∞—á—É –Ω–∞–∑—ã–≤–∞—é—Ç —Ä–∞–∑–¥–µ–ª—è—é—â–∏–º –ò–õ–ò (xor). –≠—Ç–∞ –ª–æ–≥–∏—á–µ—Å–∫–∞—è –æ–ø–µ—Ä–∞—Ü–∏—è —Ä–∞–≤–Ω–∞ –∏—Å—Ç–∏–Ω–µ (–µ–¥–∏–Ω–∏—Ü–µ) —Ç–æ–ª—å–∫–æ, –µ—Å–ª–∏ –æ–¥–∏–Ω –∏–∑ –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤ —Ä–∞–≤–µ–Ω –∏—Å—Ç–∏–Ω–µ, –∞ –≤—Ç–æ—Ä–æ–π –ª–∂–∏ (–Ω—É–ª—é):   

**–§—É–Ω–∫—Ü–∏—è XOR**
<img src="images/XOR.png" alt="hyper_neuron" height=20% width=20%>
* `(0,0) -> 0`
* `(0,1) -> 1`
* `(1,0) -> 1`
* `(1,1) -> 0`

–ß—Ç–æ–±—ã –ø—Ä–æ–≤–µ—Å—Ç–∏ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—é, –Ω–µ–æ–±—Ö–æ–¥–∏–º–∞ –Ω–µ–π—Ä–æ–Ω–Ω–∞—è —Å–µ—Ç—å —Å –æ–¥–Ω–∏–º —Å–∫—Ä—ã—Ç—ã–º —Å–ª–æ–µ–º.
–ù–∏–∂–µ –Ω–∞ –ø–µ—Ä–≤–æ–º –≥—Ä–∞—Ñ–∏–∫–µ (–≤ –æ—Å—è—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ x1 –∏ x2) –ø–æ–∫–∞–∑–∞–Ω—ã –¥–≤–µ –≥–∏–ø–µ—Ä–ø–ª–æ—Å–∫–æ—Å—Ç–∏ (–ª–∏–Ω–∏–∏ A –∏ B).
–û–Ω–∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—Ç –¥–≤—É–º —Å–∫—Ä—ã—Ç—ã–º –Ω–µ–π—Ä–æ–Ω–∞–º A –∏ B.
–ó–Ω–∞—á–µ–Ω–∏—è –≤—ã—Ö–æ–¥–æ–≤ –Ω–µ–π—Ä–æ–Ω–æ–≤ –ø—Ä–∏–≤–µ–¥–µ–Ω—ã –Ω–∞ –≤—Ç–æ—Ä–æ–º –≥—Ä–∞—Ñ–∏–∫–µ (–æ—Å–∏ yA –∏ yB). 

<img src="images/hiden_layer.png" alt="hiden_layer" height=50% width=50%>

–ö—Ä—É–∂–æ–∫ —Å –ø—Ä–∏–∑–Ω–∞–∫–∞–º–∏ (0,0) –∏–∑ –≤–µ—Ä—Ö–Ω–µ–≥–æ –ª–µ–≤–æ–≥–æ —É–≥–ª–∞ –ø–ª–æ—Å–∫–æ—Å—Ç–∏ $x_1, x_2$ –¥–∞—Å—Ç –Ω–∞ –≤—ã—Ö–æ–¥–∞—Ö –Ω–µ–π—Ä–æ–Ω–æ–≤ $y_A~0, y_B~1$ (—ç—Ç–æ—Ç –æ–±—ä–µ–∫—Ç –ª–µ–∂–∏—Ç –ø—Ä–æ—Ç–∏–≤ –≤–µ–∫—Ç–æ—Ä–∞ –Ω–æ—Ä–º–∞–ª–∏ –ø–ª–æ—Å–∫–æ—Å—Ç–∏ A –∏ –ø–æ –≤–µ–∫—Ç–æ—Ä—É –Ω–æ—Ä–º–∞–ª–∏ –ø–ª–æ—Å–∫–æ—Å—Ç–∏ B).
–í—Ç–æ—Ä–æ–π –∫—Ä—É–∂–æ–∫ —Å –ø—Ä–∏–∑–Ω–∞–∫–∞–º–∏ (1,1) –¥–∞—Å—Ç –Ω–∞ –≤—ã—Ö–æ–¥–∞—Ö –Ω–µ–π—Ä–æ–Ω–æ–≤ –∑–Ω–∞—á–µ–Ω–∏—è $y_A~1, y_B~0$.
–ü–æ–ª—É—á–∏–≤—à–µ–µ—Å—è "–¥–µ—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ" –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ $y_A$ –∏ $y_B$ (–≤—Ç–æ—Ä–æ–π –≥—Ä–∞—Ñ–∏–∫) —É–∂–µ –ª–µ–≥–∫–æ —Ä–∞–∑–¥–µ–ª–∏—Ç—å –æ–¥–Ω–æ–π –ø–ª–æ—Å–∫–æ—Å—Ç—å—é C, –∫–æ—Ç–æ—Ä–∞—è –∏ –±—É–¥–µ—Ç –≤—ã—Ö–æ–¥–Ω—ã–º –Ω–µ–π—Ä–æ–Ω–æ–º —Å–µ—Ç–∏.  

–ù–∏–∂–µ –ø—Ä–∏–≤–µ–¥–µ–Ω —Ä–µ–∞–ª—å–Ω—ã–π –ø—Ä–∏–º–µ—Ä –Ω–µ–π—Ä–æ–Ω–Ω–æ–π —Å–µ—Ç–∏, –æ–±—É—á–µ–Ω–Ω–æ–π —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞—Ç—å –¥–≤–∞ –∫–ª–∞—Å—Å–∞ –æ–±—ä–µ–∫—Ç–æ–≤, –∫–∞–∂–¥—ã–π –∏–∑ –∫–æ—Ç–æ—Ä—ã—Ö —Ä–∞–∑–±–∏–≤–∞–µ—Ç—Å—è –Ω–∞ –¥–≤–∞ –∫–ª–∞—Å—Ç–µ—Ä–∞:  

<img src="images/xor_net.png" alt="xor_net" height=40% width=40%>

–ö–∞–∂–¥—ã–π —Å–ª–æ–π —Å–µ—Ç–∏ –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç –≤—Ö–æ–¥–Ω–æ–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –≤ –Ω–µ–∫–æ—Ç–æ—Ä–æ–µ –¥—Ä—É–≥–æ–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ, –≤–æ–∑–º–æ–∂–Ω–æ, —Å –∏–Ω–æ–π —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å—é. –¢–∞–∫–æ–µ –Ω–µ–ª–∏–Ω–µ–π–Ω–æ–µ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –¥–æ —Ç–µ—Ö –ø–æ—Ä, –ø–æ–∫–∞ –∫–ª–∞—Å—Å—ã –Ω–µ –æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è –ª–∏–Ω–µ–π–Ω–æ —Ä–∞–∑–¥–µ–ª–∏–º—ã–º–∏ –Ω–µ–π—Ä–æ–Ω–∞–º–∏ –≤—ã—Ö–æ–¥–Ω–æ–≥–æ —Å–ª–æ—è. 

#### 4 –í–∞—Ä–∏–∞–Ω—Ç–∞ XOR
<img src="images/4_xor.png" alt="xor_net" height=60% width=60%>
–ü–æ—Å–ª–µ–¥–Ω–∏–π —Ä—è–¥ –∫–∞—Ä—Ç–∏–Ω–æ–∫ - —ç—Ç–æ –∫–∞—Ä—Ç—ã –≤—ã—Ö–æ–¥–∞ —Ä–µ–∞–ª—å–Ω–æ –æ–±—É—á–µ–Ω–Ω—ã—Ö –Ω–µ–π—Ä–æ–Ω–Ω—ã—Ö —Å–µ—Ç–µ–π.

## –ê–ø–ø—Ä–æ–∫—Å–∏–º–∞—Ü–∏—è —Ñ—É–Ω–∫—Ü–∏–∏ f(x)

–ü—Ä–∏ –ø–æ–º–æ—â–∏ –Ω–µ–π—Ä–æ–Ω–Ω–æ–π —Å–µ—Ç–∏ —Å –æ–¥–Ω–∏–º –≤—Ö–æ–¥–æ–º, –æ–¥–Ω–∏–º –≤—ã—Ö–æ–¥–æ–º –∏ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –±–æ–ª—å—à–∏–º —Å–∫—Ä—ã—Ç—ã–º —Å–ª–æ–µ–º, –º–æ–∂–Ω–æ –∞–ø–ø—Ä–æ–∫—Å–∏–º–∏—Ä–æ–≤–∞—Ç—å –ª—é–±—É—é —Ñ—É–Ω–∫—Ü–∏—é y=f(x).
–î–ª—è –¥–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤–∞, —Å–æ–∑–¥–∞–¥–∏–º —Å–Ω–∞—á–∞–ª–∞ —Å–µ—Ç—å, –∫–æ—Ç–æ—Ä–∞—è –Ω–∞ –≤—ã—Ö–æ–¥–µ –¥–∞—ë—Ç 1, –µ—Å–ª–∏ –≤—Ö–æ–¥ –ª–µ–∂–∏—Ç –≤ –¥–∏–∞–ø–∞–∑–æ–Ω–µ [a...b] –∏ 0 - –≤ –ø—Ä–æ—Ç–∏–≤–Ω–æ–º —Å–ª—É—á–∞–µ.

–ü—É—Å—Ç—å œÉ(d) = S(œâ¬∑d) - —Å–∏–≥–º–æ–∏–¥–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è, –∞—Ä–≥—É–º–µ–Ω—Ç –∫–æ—Ç–æ—Ä–æ–π —É–º–Ω–æ–∂–µ–Ω –Ω–∞ –±–æ–ª—å—à–æ–µ —á–∏—Å–ª–æ œâ, —Ç–∞–∫ —á—Ç–æ –ø–æ–ª—É—á–∞–µ—Ç—Å—è –ø—Ä—è–º–æ—É–≥–æ–ª—å–Ω–∞—è —Å—Ç—É–ø–µ–Ω—å–∫–∞. –ü—Ä–∏ –ø–æ–º–æ—â–∏ –¥–≤—É—Ö —Ç–∞–∫–∏—Ö —Å—Ç—É–ø–µ–Ω–µ–∫, –º–æ–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å —Å—Ç–æ–ª–±–∏–∫ –µ–¥–∏–Ω–∏—á–Ω–æ–π –≤—ã—Å–æ—Ç—ã: 

<img src="images/2_neurons.png" alt="2_neurons" height=60% width=60%>

–ù–æ—Ä–º–∏—Ä—É–µ–º –∞–ø–ø—Ä–æ–∫—Å–∏–º–∏—Ä—É–µ–º—É—é —Ñ—É–Ω–∫—Ü–∏—é y=f(x) –Ω–∞ –∏–Ω—Ç–µ—Ä–≤–∞–ª [0...1] –∫–∞–∫ –¥–ª—è –µ—ë –∞—Ä–≥—É–º–µ–Ω—Ç–∞ x, —Ç–∞–∫ –∏ –¥–ª—è –∑–Ω–∞—á–µ–Ω–∏—è y. –†–∞–∑–æ–±—ä—ë–º –¥–∏–∞–ø–∞–∑–æ–Ω –∏–∑–º–µ–Ω–µ–Ω–∏—è x=[0...1] –Ω–∞ –±–æ–ª—å—à–æ–µ —á–∏—Å–ª–æ –∏–Ω—Ç–µ—Ä–≤–∞–ª–æ–≤ (–Ω–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ —Ä–∞–≤–Ω—ã—Ö). –ù–∞ –∫–∞–∂–¥–æ–º –∏–Ω—Ç–µ—Ä–≤–∞–ª–µ —Ñ—É–Ω–∫—Ü–∏—è –¥–æ–ª–∂–Ω–∞ –º–µ–Ω—è–µ—Ç—Å—è –Ω–µ–∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ. –ù–∏–∂–µ –ø—Ä–∏–≤–µ–¥–µ–Ω–æ –¥–≤–∞ —Ç–∞–∫–∏—Ö –∏–Ω—Ç–µ—Ä–≤–∞–ª–∞: 


<img src="images/4_neurons.png" alt="2_neurons" height=60% width=60%>


–ö–∞–∂–¥–∞—è –ø–∞—Ä–∞ –Ω–µ–π—Ä–æ–Ω–æ–≤ –≤ —Å–∫—Ä—ã—Ç–æ–º —Å–ª–æ–µ —Ä–µ–∞–ª–∏–∑—É–µ—Ç –µ–¥–∏–Ω–∏—á–Ω—ã–π —Å—Ç–æ–ª–±–∏–∫. –í–µ–ª–∏—á–∏–Ω–∞ d —Ä–∞–≤–Ω–∞ $w_1$, –µ—Å–ª–∏ x‚àà(a,b) –∏ $w_2$, –µ—Å–ª–∏ x‚àà(b,—Å). –ï—Å–ª–∏ –≤—ã—Ö–æ–¥–Ω–æ–π –Ω–µ–π—Ä–æ–Ω —è–≤–ª—è–µ—Ç—Å—è –ª–∏–Ω–µ–π–Ω—ã–º —Å—É–º–º–∞—Ç–æ—Ä–æ–º, —Ç–æ –º–æ–∂–Ω–æ –ø–æ–ª–æ–∂–∏—Ç—å $w_i=f_i$, –≥–¥–µ $f_i$ - –∑–Ω–∞—á–µ–Ω–∏—è —Ñ—É–Ω–∫—Ü–∏–∏ –Ω–∞ –∫–∞–∂–¥–æ–º –∏–Ω—Ç–µ—Ä–≤–∞–ª–µ. –ï—Å–ª–∏ –∂–µ –≤—ã—Ö–æ–¥–Ω–æ–π –Ω–µ–π—Ä–æ–Ω - –æ–±—ã—á–Ω—ã–π –Ω–µ–ª–∏–Ω–µ–π–Ω—ã–π —ç–ª–µ–º–µ–Ω—Ç, —Ç–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –ø–µ—Ä–µ—Å—á–∏—Ç–∞—Ç—å –≤–µ—Å–∞ $w_i$ –ø—Ä–∏ –ø–æ–º–æ—â–∏ –æ–±—Ä–∞—Ç–Ω–æ–π –∫ —Å–∏–≥–º–æ–∏–¥—É —Ñ—É–Ω–∫—Ü–∏–∏ (–ø–æ—Å–ª–µ–¥–Ω—è—è —Ñ–æ—Ä–º—É–ª–∞).

#### –ê–ø–ø—Ä–æ–∫—Å–∏–º–∞—Ü–∏—è —Ñ—É–Ω–∫—Ü–∏–∏ –Ω–∞ Python
```python
import numpy as np                    # –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ —á–∏—Å–ª–µ–Ω–Ω—ã—Ö –º–µ—Ç–æ–¥–æ–≤ 
import matplotlib.pyplot as plt       # –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ —Ä–∏—Å–æ–≤–∞–Ω–∏—è –≥—Ä–∞—Ñ–∏–∫–æ–≤


def F(x):                             # —ç—Ç—É —Ñ—É–Ω–∫—Ü–∏—é –∞–ø–ø—Ä–æ–∫—Å–∏–º–∏—Ä—É–µ–º
    return np.sin(np.pi*x);
 
n=10                                  # —á–∏—Å–ª–æ –∏–Ω—Ç–µ—Ä–≤–∞–ª–æ–≤
x1 = np.arange(0,   1,     1/n)       # –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –ª–µ–≤—ã—Ö –≥—Ä–∞–Ω–∏—Ü
x2 = np.arange(1/n, 1+1/n, 1/n)       # –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –ø—Ä–∞–≤—ã—Ö –≥—Ä–∞–Ω–∏—Ü
print("x1:",x1,"\nx2:",x2)            # –≤—ã–≤–æ–¥–∏–º —ç—Ç–∏ –º–∞—Å—Å–∏–≤—ã
 
f  = F( (x1+x2)/2 )                   # —Ñ—É–Ω–∫—Ü–∏—è –≤ —Å–µ—Ä–µ–¥–∏–Ω–µ –∏–Ω—Ç–µ—Ä–≤–∞–ª–∞
fi = np.log( f/(1-f) )                # –æ–±—Ä–∞—Ç–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –∫ —Å–∏–≥–º–æ–∏–¥—É
 
def S(z, z0, s):                      # —Å–∏–≥–º–æ–∏–¥
    return 1/(1+np.exp(-100*s*(z-z0)))
 
def Net(z):                           # –≤—ã—Ö–æ–¥ —Å–µ—Ç–∏
    return 1/(1+np.exp(-np.dot(fi, S(z, x1, 1) + S(z, x2, -1) -1)))
 
x = np.arange(0.01, 1, 0.01)          # –º–∞—Å—Å–∏–≤ x-–æ–≤
y = [ Net(z)  for z in x ]            # –º–∞—Å—Å–∏–≤ y-–æ–≤ (–≤—ã—Ö–æ–¥ —Å–µ—Ç–∏)
 
plt.plot(x, y)                        # —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ä–∞–±–æ—Ç—ã
plt.plot(x, F(x))                     # –∏—Å—Ö–æ–¥–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è
plt.show()                            # –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –∫–∞—Ä—Ç–∏–Ω–∫—É
```
    x1: [0.  0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9] 
    x2: [0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1. ]

![png](images/11_XOR_11_1.png)


# –ó–∞–¥–∞–Ω–∏–µ
0. –ù–µ–ª—å–∑—è –ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è —Ñ—Ä–µ–π–º–≤–æ—Ä–∫–∞–º–∏ –≥–ª—É–±–æ–∫–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è - Pytorch, TensorFlow, Keras –∏ —Ç.–¥.
1. –†–∞—Å—Å—á–∏—Ç–∞—Ç—å average_digit (–º–∞—Ç—Ä–∏—Ü—É –≤–µ—Å–æ–≤) –¥–ª—è –∫–∞–∂–¥–æ–π —Ü–∏—Ñ—Ä—ã –æ—Ç 0 –¥–æ 9, –ø–æ –∞–Ω–∞–ª–æ–≥–∏–∏ —Å (avg_eight). 
2. –°–æ–∑–¥–∞—Ç—å –¥–µ—Å—è—Ç—å –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ç–æ—Ä–æ–≤ —Å –≤–µ—Å–∞–º–∏ "avg_digit". –ù–∞ –≤—Ö–æ–¥ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ç–æ—Ä–∞ –ø–æ–¥–∞—ë—Ç—Å—è —Ü–∏—Ñ—Ä–∞ –∏–∑ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –Ω–∞–±–æ—Ä–∞, –∞ –Ω–∞ –≤—ã—Ö–æ–¥–µ –º—ã –ø–æ–ª—É—á–∞–µ–º 0 –∏–ª–∏ 1, –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ç–æ–≥–æ –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∏—Ç –ª–∏ —Ü–∏—Ñ—Ä–∞ –Ω—É–∂–Ω–æ–º—É –∫–ª–∞—Å—Å—É ('0' - '9'). –î–æ–±–∞–≤–∏—Ç—å —Å–º–µ—â–µ–Ω–∏–µ (bias).
2. –†–∞—Å—Å—á–∏—Ç–∞—Ç—å —Ç–æ—á–Ω–æ—Å—Ç—å –∫–∞–∂–¥–æ–≥–æ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ç–æ—Ä–∞.
3. –û–±—ä–µ–¥–µ–Ω–∏—Ç—å –ø–æ–ª—É—á–∏–≤—à–∏–µ—Å—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ç–æ—ã –≤ –æ–¥–Ω—É –º–æ–¥–µ–ª—å, –∫–æ—Ç–æ—Ä–∞—è –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –∫–∞—Ä—Ç–∏–Ω–∫—É, –∞ –≤—ã–¥–∞—ë—Ç –≤–µ–∫—Ç–æ—Ä —Ä–∞–∑–º–µ—Ä–∞ 10. (–Ω–∞–ø—Ä. input=[3], output = [0, 0, 0, 1, 0, 0, 0, 0, 0, 0]).
4. –†–∞—Å—Å—á–∏—Ç–∞—Ç—å ùëùùëüùëíùëêùëñùë†ùëñùëúùëõ –∏ ùëüùëíùëêùëéùëôùëô –ø–æ–ª—É—á–∏–≤—à–µ–π—Å—è –º–æ–¥–µ–ª–∏ –Ω–∞ —Ç–µ—Å—Ç–æ–≤–æ–º –Ω–∞–±–æ—Ä–µ.
5. –í–∏–∑—É–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –Ω–∞–±–æ—Ä –Ω–µ–æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö —Å –ø–æ–º–æ—â—å—é –∞–ª–≥–æ—Ä–∏—Ç–º–∞ t-SNE. –í–∑—è—Ç—å 30 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –∫–∞–∂–¥–æ–≥–æ –∫–ª–∞—Å—Å–∞, –∫–∞–∂–¥–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ø–µ—Ä–µ–≤–µ—Å—Ç–∏ –≤ –≤–µ–∫—Ç–æ—Ä —Ä–∞–∑–º–µ—Ä–∞ (784), –≤–∏–∑—É–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ø–æ–ª—É—á–µ–Ω–Ω—ã–µ –≤–µ–∫—Ç–æ—Ä–∞ —Å –ø–æ–º–æ—â—å—é t-SNE.
6. –í–∏–∑—É–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ä–∞–±–æ—Ç—ã –≤–∞—à–µ–π –º–æ–¥–µ–ª–∏ (–ª–æ–≥–∏—Ç—ã) —Å –ø–æ–º–æ—â—å—é –∞–ª–≥–æ—Ä–∏—Ç–º–∞ t-SNE. –ü—Ä–æ–≥–Ω–∞—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è —á–µ—Ä–µ–∑ –≤–∞—à—É –º–æ–¥–µ–ª—å, –ø–æ–ª—É—á–∏–≤—à–∏–µ—Å—è –≤–µ–∫—Ç–æ—Ä–∞ —Ä–∞–∑–º–µ—Ä–∞ (10) –≤–∏–∑—É–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Å –ø–æ–º–æ—â—å—é t-SNE.

$precision = {TP \over TP + FP} $
$recall = {TP \over TP + FN}$

## –ß—Ç–æ –¥–æ–ª–∂–Ω–æ –ø–æ–ª—É—á–∏—Ç—å—Å—è (–ø—Ä–∏–º–µ—Ä–Ω–æ):
MNIST_images
<img src="images/mnist_training_data_tSNE.png" alt="Regression" height=30% width=30%>
MNIST_embeddings
<img src="images/mnist_embeddings_tSNE.png" alt="Regression" height=30% width=30%>

